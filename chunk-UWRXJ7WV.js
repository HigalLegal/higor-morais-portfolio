import{a as $}from"./chunk-QZQENJXC.js";import{b as ie}from"./chunk-HGAYZBT6.js";import{a as ee,b as te}from"./chunk-RP7TITJD.js";import{a as H,d as Q,e as X,f as Y,g as Z}from"./chunk-PLVZUAG5.js";import"./chunk-EKQTQDRF.js";import{c as V}from"./chunk-HX6CW5MK.js";import{d as L,h as T,i as N,j as W,k as B,l as E,m as w,o as A,p as x,q}from"./chunk-I7IS6JXF.js";import{a as K}from"./chunk-BLZU37RY.js";import{a as z}from"./chunk-M2RHVKMT.js";import"./chunk-RZOFHZQL.js";import"./chunk-EM2WCG4M.js";import{n as G}from"./chunk-6BXR4CBA.js";import"./chunk-QQMGSK2W.js";import"./chunk-XFF5VJPY.js";import{e as k,g as O}from"./chunk-GQH7GEWZ.js";import{u as D,v as U}from"./chunk-7NQHDTFN.js";import{E as J}from"./chunk-FO7KHA5M.js";import{k as F,m as P}from"./chunk-R43BVMU7.js";import{$b as f,Ab as s,Bb as n,Cb as a,Kb as g,Va as r,Zb as m,_a as p,_b as h,bc as M,cc as y,dc as b,gb as I,hc as c,oc as j,sa as d,x as S,xb as _,yb as C,zb as R}from"./chunk-XWV3PDOS.js";var v=()=>({standalone:!0}),re=()=>({"pointer-events":"none",opacity:"0.5"}),ne=()=>({});function ae(u,e){if(u&1&&(n(0,"mat-option",7),m(1),a()),u&2){let i=e.$implicit;s("value",i.id),r(),f(" ",i.name," ")}}var oe=class u{constructor(e,i,t,l,o,le){this.translate=e;this.router=i;this.activeRouter=t;this.snackBarService=l;this.projectService=o;this.technologyService=le}TRANSLATE_JSON="formProject";MIN=3;description=d("");urlRepository=d("");importanceLevel=d(null);technologiesWorkedId=d([]);image=d(null);i18n={description:"",urlRepository:"",importanceLevel:"",technologiesWorked:"",submit:""};technologies=[];idRouter=null;get importanceLevelValue(){return this.importanceLevel()}set importanceLevelValue(e){this.importanceLevel.set(e)}get technologiesWorkedIdValue(){return this.technologiesWorkedId()}set technologiesWorkedIdValue(e){this.technologiesWorkedId.set(e)}disableButton=j(()=>!(this.description().length>this.MIN&&this.urlRepository().length>this.MIN&&this.importanceLevel()!==null&&this.technologiesWorkedId().length>0&&this.validateImage()));ngOnInit(){this.insertI18N(),this.searchTechnologies(),this.insertId()}ngAfterViewInit(){this.searchProjectById()}onSubmit(){let e=this.importanceLevel(),i={description:this.description(),urlRepository:this.urlRepository(),importanceLevel:e||0,technologiesWorkedId:this.technologiesWorkedId()};this.router.url.includes("inserir-projeto")?this.postCreate(i,this.image()):this.putUpdate(i,this.image())}handleImage(e){this.image.set(e)}postCreate(e,i){this.projectService.postCreate(e,i).subscribe({next:()=>{this.openSnackBar(),this.clearFields()},error:t=>{console.error("Erro inesperado! ",t)}})}putUpdate(e,i){this.idRouter&&this.projectService.putUpdate(this.idRouter,e,i).subscribe({next:()=>{this.openSnackBar(),this.router.navigate(["/"])},error:t=>{console.error("Erro inesperado! ",t)}})}searchProjectById(){this.idRouter&&this.projectService.getById(this.idRouter).subscribe({next:e=>{this.insertFields(e)},error:e=>{console.error("Erro inesperado! ",e)}})}openSnackBar(){this.snackBarService.openSnackBarSucess("Projeto salvo com \xEAxito!")}searchTechnologies(){this.technologyService.getAll().subscribe({next:e=>{this.technologies=e},error:e=>{console.error("Erro inesperado!",e)}})}insertFields(e){this.description.set(e.description),this.urlRepository.set(e.urlRepository),this.importanceLevel.set(e.importanceLevel),this.technologiesWorkedId.set(this.technologieForName(e.technologiesWorked).map(i=>i.id))}clearFields(){this.description.set(""),this.urlRepository.set(""),this.importanceLevel.set(null),this.technologiesWorkedId.set([]),this.image.set(null)}insertId(){this.activeRouter.paramMap.subscribe(e=>{this.idRouter=e.get("id")})}technologieForName(e){return this.technologies.filter(i=>e.includes(i.name))}recoverValue(e){return this.translate.retrieveKeyValueObservable(`${this.TRANSLATE_JSON}.${e}`)}observableRequests(){return[this.recoverValue("description"),this.recoverValue("urlRepository"),this.recoverValue("importanceLevel"),this.recoverValue("technologiesWorked"),this.recoverValue("submit")]}insertI18N(){S(this.observableRequests()).subscribe({next:([e,i,t,l,o])=>{this.i18n={description:e,urlRepository:i,importanceLevel:t,technologiesWorked:l,submit:o}},error:e=>{console.error("Erro inesperado! "+e)}})}validateImage(){return this.router.url.includes("inserir-projeto")?!!this.image():!0}static \u0275fac=function(i){return new(i||u)(p(J),p(O),p(k),p(G),p(z),p(K))};static \u0275cmp=I({type:u,selectors:[["app-project-form"]],decls:23,vars:21,consts:[[1,"form-container"],[3,"submit"],["appearance","fill"],["matInput","","name","description","required","",3,"ngModelChange","ngModel","ngModelOptions"],["matInput","","name","urlRepository","required","",3,"ngModelChange","ngModel","ngModelOptions"],["matInput","","type","number","name","importanceLevel","min","0","required","",3,"ngModelChange","ngModel","ngModelOptions"],["name","technologies","multiple","",3,"ngModelChange","ngModel","ngModelOptions"],[3,"value"],[3,"image","imageFile"],["mat-raised-button","","color","primary","type","submit",3,"ngStyle"]],template:function(i,t){i&1&&(n(0,"div",0)(1,"form",1),g("submit",function(){return t.onSubmit()}),n(2,"mat-form-field",2)(3,"mat-label"),m(4),a(),n(5,"input",3),g("ngModelChange",function(o){return t.description.set(o)}),a()(),n(6,"mat-form-field",2)(7,"mat-label"),m(8),a(),n(9,"input",4),g("ngModelChange",function(o){return t.urlRepository.set(o)}),a()(),n(10,"mat-form-field",2)(11,"mat-label"),m(12),a(),n(13,"input",5),b("ngModelChange",function(o){return y(t.importanceLevelValue,o)||(t.importanceLevelValue=o),o}),a()(),n(14,"mat-form-field",2)(15,"mat-label"),m(16),a(),n(17,"mat-select",6),b("ngModelChange",function(o){return y(t.technologiesWorkedIdValue,o)||(t.technologiesWorkedIdValue=o),o}),C(18,ae,2,2,"mat-option",7,_),a()(),n(20,"app-file-upload",8),g("image",function(o){return t.handleImage(o)}),a(),n(21,"button",9),m(22),a()()()),i&2&&(r(4),h(t.i18n.description),r(),s("ngModel",t.description())("ngModelOptions",c(15,v)),r(3),h(t.i18n.urlRepository),r(),s("ngModel",t.urlRepository())("ngModelOptions",c(16,v)),r(3),h(t.i18n.importanceLevel),r(),M("ngModel",t.importanceLevelValue),s("ngModelOptions",c(17,v)),r(3),h(t.i18n.technologiesWorked),r(),M("ngModel",t.technologiesWorkedIdValue),s("ngModelOptions",c(18,v)),r(),R(t.technologies),r(2),s("imageFile",t.image()),r(),s("ngStyle",t.disableButton()?c(19,re):c(20,ne)),r(),f(" ",t.i18n.submit," "))},dependencies:[q,E,L,w,T,N,x,A,B,W,X,Q,H,Z,Y,U,D,P,F,te,ee,V,ie,$],styles:[".form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-width:400px;width:100%;margin-top:200px}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   app-file-upload[_ngcontent-%COMP%]{margin-bottom:16px}","@media (max-width: 420px){.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:300px}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   app-file-upload[_ngcontent-%COMP%]{width:98%!important}}"]})};export{oe as ProjectFormComponent};
