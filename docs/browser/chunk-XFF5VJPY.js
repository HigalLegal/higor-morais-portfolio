import{Z as c,sa as l}from"./chunk-XWV3PDOS.js";var r=class extends Error{};r.prototype.name="InvalidTokenError";function g(n){return decodeURIComponent(atob(n).replace(/(.)/g,(e,t)=>{let o=t.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function f(n){let e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return g(e)}catch{return atob(e)}}function d(n,e){if(typeof n!="string")throw new r("Invalid token specified: must be a string");e||(e={});let t=e.header===!0?0:1,o=n.split(".")[t];if(typeof o!="string")throw new r(`Invalid token specified: missing part #${t+1}`);let s;try{s=f(o)}catch(a){throw new r(`Invalid token specified: invalid base64 for part #${t+1} (${a.message})`)}try{return JSON.parse(s)}catch(a){throw new r(`Invalid token specified: invalid json for part #${t+1} (${a.message})`)}}var i="auth_token",p=class n{tokenSignal=l(localStorage.getItem(i));constructor(){}get token(){return this.tokenSignal()}setToken(e){localStorage.setItem(i,e),this.tokenSignal.set(e)}clearToken(){localStorage.removeItem(i),this.tokenSignal.set(null)}isAdmin(){let e=this.tokenSignal();if(e){let t=d(e);return t.groups.filter(o=>o.toLowerCase()==="admin").length>0&&this.isValid(t.exp)}return!1}isValid(e){let t=new Date;return new Date(e*1e3)>t}static \u0275fac=function(t){return new(t||n)};static \u0275prov=c({token:n,factory:n.\u0275fac,providedIn:"root"})};export{p as a};
