import{a as ce,b as pe}from"./chunk-HGAYZBT6.js";import{a as se,b as le}from"./chunk-RP7TITJD.js";import{a as ne,d as ie,e as re,f as oe,g as ae}from"./chunk-PLVZUAG5.js";import{b as H}from"./chunk-UMUXFDNI.js";import"./chunk-EKQTQDRF.js";import{c as q}from"./chunk-HX6CW5MK.js";import{d as j,h as L,i as J,j as U,k as z,l as G,p as Y,q as K}from"./chunk-I7IS6JXF.js";import{a as ee}from"./chunk-PJMEV3LH.js";import{a as te}from"./chunk-J4OHAFBT.js";import"./chunk-RZOFHZQL.js";import"./chunk-X2KLAOIO.js";import{n as $}from"./chunk-6BXR4CBA.js";import"./chunk-QQMGSK2W.js";import"./chunk-XFF5VJPY.js";import{e as A,g as P}from"./chunk-GQH7GEWZ.js";import{u as Q,v as X}from"./chunk-7NQHDTFN.js";import{E as Z}from"./chunk-FO7KHA5M.js";import{k as B,m as W}from"./chunk-R43BVMU7.js";import{$b as F,Ab as c,Bb as s,Cb as l,Db as I,Hb as O,Kb as _,Lb as f,Va as r,Zb as p,_a as u,_b as m,bc as v,cc as b,dc as C,gb as x,hc as d,ia as w,ja as V,oc as E,sa as g,vb as M,wb as y,x as D,xb as N,yb as k,zb as R}from"./chunk-XWV3PDOS.js";var S=class a{text="";static \u0275fac=function(t){return new(t||a)};static \u0275cmp=x({type:a,selectors:[["app-text-error"]],inputs:{text:"text"},decls:2,vars:1,template:function(t,n){t&1&&(s(0,"p"),p(1),l()),t&2&&(r(),m(n.text))},styles:["p[_ngcontent-%COMP%]{color:#ff4747;font-family:Cormorant Garamond;font-size:1.25rem}"]})};var h=()=>({standalone:!0}),ve=()=>({"pointer-events":"none",opacity:"0.5"}),be=()=>({});function Ce(a,e){if(a&1){let t=O();s(0,"mat-form-field",1)(1,"mat-label"),p(2),l(),s(3,"input",10),C("ngModelChange",function(o){w(t);let i=f();return b(i.endValue,o)||(i.endValue=o),V(o)}),l()()}if(a&2){let t=f();r(2),m(t.i18n.end),r(),v("ngModel",t.endValue),c("ngModelOptions",d(3,h))}}function xe(a,e){if(a&1&&(s(0,"mat-option",7),p(1),l()),a&2){let t=e.$implicit;c("value",t.id),r(),F(" ",t.name," ")}}function Me(a,e){if(a&1&&I(0,"app-text-error",8),a&2){let t=f();c("text",t.i18n.labelBeginningAfterEnd)}}function ye(a,e){if(a&1&&I(0,"app-text-error",8),a&2){let t=f();c("text",t.i18n.labelFutureDate)}}var me=class a{constructor(e,t,n,o,i,T){this.translate=e;this.experienceService=t;this.technologyService=n;this.router=o;this.activeRouter=i;this.snackbarService=T;this.currentRouter=this.router.url}TRANSLATE_JSON="formExperience";MIN=3;currentRouter="";idRouter=null;companyName=g("");description=g("");beginning=g(null);end=g(null);isCurrent=g(!1);technologiesWorkedId=g([]);technologies=[];i18n={companyName:"",description:"",beginning:"",actually:"",end:"",technologiesWorked:"",labelBeginningAfterEnd:"",labelFutureDate:"",submit:""};get beginningValue(){let e=this.beginning();return e?this.formatDateToBR(e):""}set beginningValue(e){this.handleDate(e,this.beginning.set)}get endValue(){let e=this.end();return e?this.formatDateToBR(e):""}set endValue(e){this.handleDate(e,this.end.set)}get isCurrentValue(){return this.isCurrent()}set isCurrentValue(e){this.isCurrent.set(e)}get technologiesWorkedIdValue(){return this.technologiesWorkedId()}set technologiesWorkedIdValue(e){this.technologiesWorkedId.set(e)}isBeginningAfterEnd=E(()=>this.validateBeginningAndEnd());isFutureDate=E(()=>this.validateDateFuture());disableButton=E(()=>this.companyName().length<=this.MIN||this.description().length<=this.MIN||!this.beginning()||this.validateEnd()||this.validateBeginningAndEnd()||this.technologiesWorkedId().length<1);ngOnInit(){this.insertI18N(),this.searchTechnologies(),this.insertId()}ngAfterViewInit(){this.searchExperienceById()}onSubmit(){let e={companyName:this.companyName(),description:this.description(),beginning:this.beginningValue,end:this.isCurrent()?null:this.endValue,technologiesWorkedId:this.technologiesWorkedId()};this.currentRouter.includes("inserir-experiencia")?this.postCreate(e):this.putUpdate(e)}validateBeginningAndEnd(){if(!this.beginning()||!this.end())return!1;let e=this.beginning(),t=this.end(),n=e?new Date(e):new Date,o=t?new Date(t):new Date;return n.getTime()>o.getTime()}searchExperienceById(){this.idRouter&&this.experienceService.getById(this.idRouter).subscribe({next:e=>{this.insertFields(e)},error:e=>{console.error("Erro inesperado!")}})}postCreate(e){this.experienceService.postCreate(e).subscribe({next:()=>{this.openSnackBar(),this.clearFields()},error:t=>{console.error("Erro inesperado! ",t)}})}putUpdate(e){this.idRouter&&this.experienceService.putUpdate(this.idRouter,e).subscribe({next:()=>{this.openSnackBar(),this.router.navigate(["/"])},error:t=>{console.error("Erro inesperado! ",t)}})}insertFields(e){this.companyName.set(e.companyName),this.description.set(e.description),this.technologiesWorkedId.set(this.technologieForName(e.technologiesWorked).map(t=>t.id))}technologieForName(e){return this.technologies.filter(t=>e.includes(t.name))}searchTechnologies(){this.technologyService.getAll().subscribe({next:e=>{this.technologies=e},error:e=>{console.error("Erro inesperado! ",e)}})}clearFields(){this.companyName.set(""),this.description.set(""),this.beginning.set(null),this.end.set(null),this.isCurrent.set(!1),this.technologiesWorkedId.set([])}handleDate(e,t){if(e.length==8){let n=this.stringToDate(e);isNaN(n.getTime())||t(n)}}recoverValue(e){return this.translate.retrieveKeyValueObservable(`${this.TRANSLATE_JSON}.${e}`)}insertId(){this.activeRouter.paramMap.subscribe(e=>{this.idRouter=e.get("id")})}openSnackBar(){this.snackbarService.openSnackBarSucess("Experi\xEAncia profissional salva com \xEAxito!")}observableRequests(){return[this.recoverValue("companyName"),this.recoverValue("description"),this.recoverValue("beginning"),this.recoverValue("actually"),this.recoverValue("end"),this.recoverValue("technologiesWorked"),this.recoverValue("labelBeginningAfterEnd"),this.recoverValue("labelFutureDate"),this.recoverValue("submit")]}insertI18N(){D(this.observableRequests()).subscribe({next:([e,t,n,o,i,T,de,ge,ue])=>{this.i18n={companyName:e,description:t,beginning:n,actually:o,end:i,technologiesWorked:T,labelBeginningAfterEnd:de,labelFutureDate:ge,submit:ue}},error:e=>{console.error("Erro inesperado! "+e)}})}stringToDate(e){let t=+e.substring(0,2),n=+e.substring(2,4)-1,o=+e.substring(4,8),i=new Date(o,n,t);return new Date(i)}validateEnd(){return!this.isCurrent()&&!this.end()}getTomorrowMidnight(){let e=new Date;return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1,0,0,0,0)}formatDateToBR(e){let t=String(e.getDate()).padStart(2,"0"),n=String(e.getMonth()+1).padStart(2,"0"),o=e.getFullYear();return`${t}/${n}/${o}`}validateDateFuture(){if(!this.beginning&&!this.end)return!1;let e=this.getTomorrowMidnight(),t=this.beginning(),n=this.end(),o=t?new Date(t):new Date,i=n?new Date(n):new Date;return o.getTime()>=e.getTime()||i.getTime()>=e.getTime()}static \u0275fac=function(t){return new(t||a)(u(Z),u(te),u(ee),u(P),u(A),u($))};static \u0275cmp=x({type:a,selectors:[["app-form-experience"]],decls:28,vars:27,consts:[[1,"form-container"],["appearance","fill"],["matInput","","name","companyName","required","",3,"ngModelChange","ngModel","ngModelOptions"],["matInput","","name","description","required","",3,"ngModelChange","ngModel","ngModelOptions"],["matInput","","name","beginning","placeholder","dd/mm/aaaa","mask","00/00/0000","required","",3,"ngModelChange","ngModel","ngModelOptions"],[3,"ngModelChange","ngModel","ngModelOptions"],["name","technologies","multiple","",3,"ngModelChange","ngModel","ngModelOptions"],[3,"value"],[3,"text"],["mat-raised-button","","color","primary","type","submit",3,"click","ngStyle"],["matInput","","name","end","placeholder","dd/mm/aaaa","mask","00/00/0000","required","",3,"ngModelChange","ngModel","ngModelOptions"]],template:function(t,n){t&1&&(s(0,"div",0)(1,"form")(2,"mat-form-field",1)(3,"mat-label"),p(4),l(),s(5,"input",2),_("ngModelChange",function(i){return n.companyName.set(i)}),l()(),s(6,"mat-form-field",1)(7,"mat-label"),p(8),l(),s(9,"textarea",3),_("ngModelChange",function(i){return n.description.set(i)}),l()(),s(10,"mat-form-field",1)(11,"mat-label"),p(12),l(),s(13,"input",4),C("ngModelChange",function(i){return b(n.beginningValue,i)||(n.beginningValue=i),i}),l()(),s(14,"mat-checkbox",5),C("ngModelChange",function(i){return b(n.isCurrentValue,i)||(n.isCurrentValue=i),i}),s(15,"span"),p(16),l()(),M(17,Ce,4,4,"mat-form-field",1),s(18,"mat-form-field",1)(19,"mat-label"),p(20),l(),s(21,"mat-select",6),C("ngModelChange",function(i){return b(n.technologiesWorkedIdValue,i)||(n.technologiesWorkedIdValue=i),i}),k(22,xe,2,2,"mat-option",7,N),l()(),M(24,Me,1,1,"app-text-error",8),M(25,ye,1,1,"app-text-error",8),s(26,"button",9),_("click",function(){return n.onSubmit()}),p(27),l()()()),t&2&&(r(4),m(n.i18n.companyName),r(),c("ngModel",n.companyName())("ngModelOptions",d(20,h)),r(3),m(n.i18n.description),r(),c("ngModel",n.description())("ngModelOptions",d(21,h)),r(3),m(n.i18n.beginning),r(),v("ngModel",n.beginningValue),c("ngModelOptions",d(22,h)),r(),v("ngModel",n.isCurrentValue),c("ngModelOptions",d(23,h)),r(2),m(n.i18n.actually),r(),y(n.isCurrent()?-1:17),r(3),m(n.i18n.technologiesWorked),r(),v("ngModel",n.technologiesWorkedIdValue),c("ngModelOptions",d(24,h)),r(),R(n.technologies),r(2),y(n.isBeginningAfterEnd()?24:-1),r(),y(n.isFutureDate()?25:-1),r(),c("ngStyle",n.disableButton()?d(25,ve):d(26,be)),r(),F(" ",n.i18n.submit," "))},dependencies:[K,G,j,L,J,Y,z,U,re,ie,ne,ae,oe,X,Q,W,B,le,se,q,H,pe,ce,S],styles:[".form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-width:400px;width:100%;margin-top:200px}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   app-text-error[_ngcontent-%COMP%]{margin-bottom:12px}.form-container[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--font-color);font-family:CinzelDecorative}","@media (max-width: 420px){.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:280px}}"]})};export{me as FormExperienceComponent};
