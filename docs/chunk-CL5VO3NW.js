import{a as ee}from"./chunk-QZQENJXC.js";import{a as te,b as ie}from"./chunk-RP7TITJD.js";import{a as Q,d as X,e as Y,f as Z,g as $}from"./chunk-PLVZUAG5.js";import{c as B}from"./chunk-HX6CW5MK.js";import{d as E,h as w,i as k,j as P,k as x,l as A,m as q,o as j,p as D,q as W}from"./chunk-I7IS6JXF.js";import{a as z}from"./chunk-PJMEV3LH.js";import{a as H}from"./chunk-BFBTHS5P.js";import"./chunk-RZOFHZQL.js";import"./chunk-X2KLAOIO.js";import{n as K}from"./chunk-6BXR4CBA.js";import"./chunk-QQMGSK2W.js";import"./chunk-XFF5VJPY.js";import{e as L,g as N}from"./chunk-GQH7GEWZ.js";import{u as U,v as J}from"./chunk-7NQHDTFN.js";import{E as G}from"./chunk-FO7KHA5M.js";import{k as V,m as T}from"./chunk-R43BVMU7.js";import{$b as f,Ab as m,Bb as o,Cb as a,Kb as g,Va as n,Zb as c,_a as l,_b as h,bc as C,cc as M,dc as I,gb as S,hc as u,oc as R,sa as p,vc as O,x as b,xb as _,yb as y,zb as F}from"./chunk-XWV3PDOS.js";var v=()=>({standalone:!0}),ne=()=>({"pointer-events":"none",opacity:"0.5"}),oe=()=>({});function ae(d,e){if(d&1&&(o(0,"mat-option",6),c(1),a()),d&2){let i=e.$implicit;m("value",i.id),n(),f(" ",i.name," ")}}var re=class d{constructor(e,i,t,s,r,se,le){this.translate=e;this.detector=i;this.router=t;this.activeRouter=s;this.technologyService=r;this.courseService=se;this.snackBarService=le;this.currentRouter=this.router.url}TRANSLATE_JSON="formCourse";MIN=3;name=p("");urlCertificate=p("");importanceLevel=p(null);technologiesIds=p([]);image=p(null);disableButton=R(()=>{let e=this.name().trim().length>this.MIN,i=this.urlCertificate().trim().length>this.MIN,t=this.importanceLevel()!==null,s=this.technologiesIds().length>0,r=this.validateImage();return!(e&&i&&t&&s&&r)});i18n={nameCourse:"",urlCertificate:"",importanceLevel:"",technologies:"",submit:""};idRouter=null;currentRouter="";technologies=[];get importanceLevelValue(){return this.importanceLevel()}set importanceLevelValue(e){this.importanceLevel.set(e)}get technologiesIdsValue(){return this.technologiesIds()}set technologiesIdsValue(e){this.technologiesIds.set(e)}ngOnInit(){this.searchTechnologies(),this.insertId()}ngAfterViewInit(){this.insertI18N(),this.detector.detectChanges(),this.searchCourseById()}onSubmit(){let e=this.importanceLevel(),i=e!==null?e:0,t={name:this.name(),urlCertificate:this.urlCertificate(),importanceLevel:i,technologiesIds:this.technologiesIds()};this.currentRouter.includes("inserir-curso")?this.postCreate(t,this.image()):this.putUpdate(t,this.image())}handleImage(e){this.image.set(e)}postCreate(e,i){this.courseService.postCreate(e,i).subscribe({next:()=>{this.openSnackBar(e.name),this.clearFields()},error:t=>{console.error("Erro inesperado! ",t)}})}putUpdate(e,i){this.idRouter&&this.courseService.putUpdate(this.idRouter,e,i).subscribe({next:()=>{this.openSnackBar(e.name),this.router.navigate(["/"])},error:t=>{console.error("Erro inesperado! ",t)}})}searchCourseById(){this.idRouter&&this.courseService.getById(this.idRouter).subscribe({next:e=>{this.insertFields(e)},error:e=>{console.error("Erro inesperado! ",e)}})}searchTechnologies(){this.technologyService.getAll().subscribe({next:e=>{this.technologies=e},error:e=>{console.error("Erro inesperado! ",e)}})}insertFields(e){this.name.set(e.name),this.urlCertificate.set(e.urlCertificate),this.importanceLevel.set(e.importanceLevel),this.technologiesIds.set(this.technologieForName(e.technologies).map(i=>i.id))}technologieForName(e){return this.technologies.filter(i=>e.includes(i.name))}insertId(){this.activeRouter.paramMap.subscribe(e=>{this.idRouter=e.get("id")})}recoverValue(e){return this.translate.retrieveKeyValueObservable(`${this.TRANSLATE_JSON}.${e}`)}openSnackBar(e){this.snackBarService.openSnackBarSucess(`${e} salvo com \xEAxito!`)}clearFields(){this.name.set(""),this.urlCertificate.set(""),this.importanceLevel.set(null),this.technologiesIds.set([]),this.image.set(null)}insertI18N(){b(this.observableRequests()).subscribe({next:([e,i,t,s,r])=>{this.i18n={nameCourse:e,urlCertificate:i,importanceLevel:t,technologies:s,submit:r}}})}observableRequests(){return[this.recoverValue("nameCourse"),this.recoverValue("urlCertificate"),this.recoverValue("importanceLevel"),this.recoverValue("techonologies"),this.recoverValue("submit")]}validateImage(){return this.currentRouter.includes("inserir-curso")?!!this.image():!0}static \u0275fac=function(i){return new(i||d)(l(G),l(O),l(N),l(L),l(z),l(H),l(K))};static \u0275cmp=S({type:d,selectors:[["app-form-course"]],decls:23,vars:21,consts:[[1,"form-container"],["appearance","fill"],["matInput","","type","text","name","name","required","",3,"ngModelChange","ngModel","ngModelOptions"],["matInput","","type","text","name","urlCertificate","required","",3,"ngModelChange","ngModel","ngModelOptions"],["matInput","","type","number","name","importanceLevel","min","0","required","",3,"ngModelChange","ngModel","ngModelOptions"],["name","technologies","multiple","",3,"ngModelChange","ngModel","ngModelOptions"],[3,"value"],[3,"image","imageFile"],["mat-raised-button","","color","primary","type","submit",3,"click","ngStyle"]],template:function(i,t){i&1&&(o(0,"div",0)(1,"form")(2,"mat-form-field",1)(3,"mat-label"),c(4),a(),o(5,"input",2),g("ngModelChange",function(r){return t.name.set(r)}),a()(),o(6,"mat-form-field",1)(7,"mat-label"),c(8),a(),o(9,"input",3),g("ngModelChange",function(r){return t.urlCertificate.set(r)}),a()(),o(10,"mat-form-field",1)(11,"mat-label"),c(12),a(),o(13,"input",4),I("ngModelChange",function(r){return M(t.importanceLevelValue,r)||(t.importanceLevelValue=r),r}),a()(),o(14,"mat-form-field",1)(15,"mat-label"),c(16),a(),o(17,"mat-select",5),I("ngModelChange",function(r){return M(t.technologiesIdsValue,r)||(t.technologiesIdsValue=r),r}),y(18,ae,2,2,"mat-option",6,_),a()(),o(20,"app-file-upload",7),g("image",function(r){return t.handleImage(r)}),a(),o(21,"button",8),g("click",function(){return t.onSubmit()}),c(22),a()()()),i&2&&(n(4),h(t.i18n.nameCourse),n(),m("ngModel",t.name())("ngModelOptions",u(15,v)),n(3),h(t.i18n.urlCertificate),n(),m("ngModel",t.urlCertificate())("ngModelOptions",u(16,v)),n(3),h(t.i18n.importanceLevel),n(),C("ngModel",t.importanceLevelValue),m("ngModelOptions",u(17,v)),n(3),h(t.i18n.technologies),n(),C("ngModel",t.technologiesIdsValue),m("ngModelOptions",u(18,v)),n(),F(t.technologies),n(2),m("imageFile",t.image()),n(),m("ngStyle",t.disableButton()?u(19,ne):u(20,oe)),n(),f(" ",t.i18n.submit," "))},dependencies:[W,A,E,q,w,k,D,j,x,P,Y,X,Q,$,Z,J,U,T,V,ie,te,B,ee],styles:[".form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-width:400px;width:100%;margin-top:200px}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   app-file-upload[_ngcontent-%COMP%]{margin-bottom:16px}","@media (max-width: 420px){.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:300px}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   app-file-upload[_ngcontent-%COMP%]{width:98%!important}}"]})};export{re as FormCourseComponent};
