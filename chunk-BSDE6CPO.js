import{a as X,b as Y}from"./chunk-RP7TITJD.js";import{a as K,d as $,e as z,f as H,g as Q}from"./chunk-PLVZUAG5.js";import{c as V}from"./chunk-HX6CW5MK.js";import{d as E,h as B,i as x,j as w,k,l as q,p as P,q as j}from"./chunk-I7IS6JXF.js";import{a as U}from"./chunk-PJMEV3LH.js";import{a as G}from"./chunk-5OU5EL5D.js";import"./chunk-RZOFHZQL.js";import"./chunk-X2KLAOIO.js";import{n as W}from"./chunk-6BXR4CBA.js";import"./chunk-QQMGSK2W.js";import"./chunk-XFF5VJPY.js";import{e as N,g as T}from"./chunk-GQH7GEWZ.js";import{u as D,v as L}from"./chunk-7NQHDTFN.js";import{E as J}from"./chunk-FO7KHA5M.js";import{k as R,m as O}from"./chunk-R43BVMU7.js";import{$b as f,Ab as m,Bb as n,Cb as l,Kb as g,Va as r,Zb as c,_a as s,_b as h,bc as b,cc as A,dc as _,gb as M,hc as d,oc as F,sa as u,x as C,xb as S,yb as y,zb as I}from"./chunk-XWV3PDOS.js";var v=()=>({standalone:!0}),ee=()=>({"pointer-events":"none",opacity:"0.5"}),te=()=>({});function ie(p,e){if(p&1&&(n(0,"mat-option",7),c(1),l()),p&2){let i=e.$implicit;m("value",i.id),r(),f(" ",i.name," ")}}var Z=class p{constructor(e,i,t,a,o,re){this.translate=e;this.articleService=i;this.technologyService=t;this.router=a;this.activeRouter=o;this.snackbarService=re}TRANSLATE_JSON="formArticle";MIN=3;title=u("");summary=u("");urlArticle=u("");technologiesCoveredId=u([]);i18n={title:"",summary:"",urlArticle:"",technologiesCovered:"",submit:""};technologies=[];idRouter=null;get technologiesCoveredIdValue(){return this.technologiesCoveredId()}set technologiesCoveredIdValue(e){this.technologiesCoveredId.set(e)}disableButton=F(()=>this.title().length<=this.MIN||this.summary().length<=this.MIN||this.urlArticle().length<=this.MIN||this.technologiesCoveredId().length<1);ngOnInit(){this.insertI18N(),this.searchTechnologies(),this.insertId()}ngAfterViewInit(){this.searchArticleById()}onSubmit(){let e={title:this.title(),summary:this.summary(),urlArticle:this.urlArticle(),technologiesCoveredId:this.technologiesCoveredId()};this.router.url.includes("inserir-artigo")?this.postCreate(e):this.putUpdate(e)}postCreate(e){this.articleService.postCreate(e).subscribe({next:()=>{this.clearFields(),this.openSnackBar()},error:i=>{console.error("Erro inesperado! ",i)}})}putUpdate(e){this.idRouter&&this.articleService.putCreate(this.idRouter,e).subscribe({next:()=>{this.openSnackBar(),this.router.navigate(["/"])},error:i=>{console.error("Erro inesperado! ",i)}})}searchArticleById(){this.idRouter&&this.articleService.getById(this.idRouter).subscribe({next:e=>{this.insertFields(e)},error:e=>{console.error("Erro inesperado! ",e)}})}clearFields(){this.title.set(""),this.summary.set(""),this.urlArticle.set(""),this.technologiesCoveredId.set([])}insertFields(e){this.title.set(e.title),this.summary.set(e.summary),this.urlArticle.set(e.urlArticle),this.technologiesCoveredId.set(this.technologieForName(e.technologiesCovered).map(i=>i.id))}technologieForName(e){return this.technologies.filter(i=>e.includes(i.name))}searchTechnologies(){this.technologyService.getAll().subscribe({next:e=>{this.technologies=e},error:e=>{console.error("Erro inesperado! ",e)}})}recoverValue(e){return this.translate.retrieveKeyValueObservable(`${this.TRANSLATE_JSON}.${e}`)}observableRequests(){return[this.recoverValue("title"),this.recoverValue("summary"),this.recoverValue("urlArticle"),this.recoverValue("technologiesCovered"),this.recoverValue("submit")]}insertI18N(){C(this.observableRequests()).subscribe({next:([e,i,t,a,o])=>{this.i18n={title:e,summary:i,urlArticle:t,technologiesCovered:a,submit:o}},error:e=>{console.error("Erro inesperado! "+e)}})}openSnackBar(){this.snackbarService.openSnackBarSucess("Artigo salvo com \xEAxito!")}insertId(){this.activeRouter.paramMap.subscribe(e=>{this.idRouter=e.get("id")})}static \u0275fac=function(i){return new(i||p)(s(J),s(G),s(U),s(T),s(N),s(W))};static \u0275cmp=M({type:p,selectors:[["app-form-article"]],decls:22,vars:20,consts:[[1,"form-container"],[3,"submit"],["appearance","fill"],["matInput","","name","title","required","",3,"ngModelChange","ngModel","ngModelOptions"],["matInput","","name","summary","required","",3,"ngModelChange","ngModel","ngModelOptions"],["matInput","","name","urlArticle","required","",3,"ngModelChange","ngModel","ngModelOptions"],["name","technologies","multiple","",3,"ngModelChange","ngModel","ngModelOptions"],[3,"value"],["mat-raised-button","","color","primary","type","submit",3,"ngStyle"]],template:function(i,t){i&1&&(n(0,"div",0)(1,"form",1),g("submit",function(){return t.onSubmit()}),n(2,"mat-form-field",2)(3,"mat-label"),c(4),l(),n(5,"input",3),g("ngModelChange",function(o){return t.title.set(o)}),l()(),n(6,"mat-form-field",2)(7,"mat-label"),c(8),l(),n(9,"textarea",4),g("ngModelChange",function(o){return t.summary.set(o)}),l()(),n(10,"mat-form-field",2)(11,"mat-label"),c(12),l(),n(13,"input",5),g("ngModelChange",function(o){return t.urlArticle.set(o)}),l()(),n(14,"mat-form-field",2)(15,"mat-label"),c(16),l(),n(17,"mat-select",6),_("ngModelChange",function(o){return A(t.technologiesCoveredIdValue,o)||(t.technologiesCoveredIdValue=o),o}),y(18,ie,2,2,"mat-option",7,S),l()(),n(20,"button",8),c(21),l()()()),i&2&&(r(4),h(t.i18n.title),r(),m("ngModel",t.title())("ngModelOptions",d(14,v)),r(3),h(t.i18n.summary),r(),m("ngModel",t.summary())("ngModelOptions",d(15,v)),r(3),h(t.i18n.urlArticle),r(),m("ngModel",t.urlArticle())("ngModelOptions",d(16,v)),r(3),h(t.i18n.technologiesCovered),r(),b("ngModel",t.technologiesCoveredIdValue),m("ngModelOptions",d(17,v)),r(),I(t.technologies),r(2),m("ngStyle",t.disableButton()?d(18,ee):d(19,te)),r(),f(" ",t.i18n.submit," "))},dependencies:[j,q,E,B,x,P,k,w,z,$,K,Q,H,L,D,O,R,Y,X,V],styles:[".form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-width:400px;width:100%;margin-top:200px}","@media (max-width: 420px){.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:300px}.form-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   app-file-upload[_ngcontent-%COMP%]{width:98%!important}}"]})};export{Z as FormArticleComponent};
